(this["webpackJsonpwithdraw-demo"]=this["webpackJsonpwithdraw-demo"]||[]).push([[0],{408:function(e,t,n){},429:function(e,t){},432:function(e,t){},434:function(e,t){},446:function(e,t){},447:function(e,t){},466:function(e,t){},468:function(e,t){},483:function(e,t){},487:function(e,t){},491:function(e,t){},493:function(e,t){},538:function(e,t){},544:function(e,t){},551:function(e,t){},579:function(e,t){},581:function(e,t){},588:function(e,t){},589:function(e,t){},607:function(e,t){},820:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),i=n(32),r=n.n(i),o=(n(408),n(409),n(77)),c=n(21),l=n(180),d=n.n(l),p=n(9),h=n(121),u=n(62),b=n.n(u),g=n(179);const x={script_type_hash:"0x5a2506bb68d81a11dcadad4cb7eae62a17c43c619fe47ac8037bc8ce2dd90360",cell_dep:{out_point:{tx_hash:"0x97614145cdec9ba924001c11cd49f1c424927437b40ed3ca3b82fff358f2e3de",index:"0x0"},dep_type:"code"}},f={code_hash:"0x79f90bb5e892d80dd213439eeab551120eb417678824f282b4ffb5f21bad2e1e",hash_type:"type",tx_hash:"0x9154df4f7336402114d04495175b37390ce86a4906d2d4001cf02c3e6d97f39c",index:"0x0",dep_type:"code"},y={script_type_hash:"0x170ef156e9f6132dbca6069dfd3e436f7d91c29d3ac7332c4b33e633b6a299b5",cell_dep:{out_point:{tx_hash:"0xb4b07dcd1571ac18683b515ada40e13b99bd0622197b6817047adc9f407f4828",index:"0x0"},dep_type:"code"}},w={script_type_hash:"0xdeec13a7b8e100579541384ccaf4b5223733e4a5483c3aec95ddc4c1d5ea5b22",cell_dep:{out_point:{tx_hash:"0x2f9f8ec8a1556238aeeefed29e990d53ea75060ef04249371fd8b5246fffb8ea",index:"0x0"},dep_type:"code"}},m={code_hash:"0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8",hash_type:"type",tx_hash:"0xf8de3bb47d055cdf460d93a2a6e1b05f7432f9777c8c474abf4eec1d4aee5d37",index:"0x0",dep_type:"dep_group",short_id:0},j={code_hash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",hash_type:"type",tx_hash:"0xe12877ebd2c3c364dc46c5c992bcfaf4fee33fa13eebdf82c591fc9825aab769",index:"0x0",dep_type:"code"},_="0x4cc2e6526204ae6a2e8fcf12f7ad472f41a1606d5b9624beebd215d780809f6a",v={code_hash:"0x5c365147bb6c40e817a2a53e0dec3661f7390cc77f0c02db138303177b12e9fb",hash_type:"type",args:"0x213743d13048e9f36728c547ab736023a7426e15a3d7d1c82f43ec3b5f266df2"},k=[{symbol:"USDC",name:"USD Coin",decimals:18,tokenURI:"https://cryptologos.cc/logos/usd-coin-usdc-logo.svg?v=002",sudt_script_hash:"",address:"0xca6FcAAA5129aD9e5219397527A17c26E5AD6a6a",issuerLockHash:"0x58bef38794236b315b7c23fd8132d7f42676228d659b291936e8c6c7ba9f064e",l1Lock:{code_hash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",hash_type:"type",args:"0x58bef38794236b315b7c23fd8132d7f42676228d659b291936e8c6c7ba9f064e"}},{symbol:"ETH",name:"Ethereum",decimals:18,tokenURI:"https://cryptologos.cc/logos/ethereum-eth-logo.svg?v=002",sudt_script_hash:"",address:"0xB1235Dd5bd72d9Ef2F0E311fC5ce7df0583B6458",issuerLockHash:"0x1b072aa0ded384067106ea0c43c85bd71bafa5afdb432123511da46b390a4e33",l1Lock:{code_hash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",hash_type:"type",args:"0x1b072aa0ded384067106ea0c43c85bd71bafa5afdb432123511da46b390a4e33"}},{symbol:"TAI",name:"NexisDAO TAI",decimals:18,tokenURI:"data:image/png;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAQDAwQDAwQEAwQFBAQFBgoHBgYGBg0JCggKDw0QEA8NDw4RExgUERIXEg4PFRwVFxkZGxsbEBQdHx0aHxgaGxr/2wBDAQQFBQYFBgwHBwwaEQ8RGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhr/wAARCAAoACgDASIAAhEBAxEB/8QAGgAAAgMBAQAAAAAAAAAAAAAAAAgEBQYBCf/EADQQAAEDAwEEBwUJAAAAAAAAAAIAAQQDBRIGBxETURUhIjJCUmIWgYKisggUFyczNEFTZ//EABkBAAMBAQEAAAAAAAAAAAAAAAMFBgIEB//EACQRAAEEAgEDBQEAAAAAAAAAAAMAAQIEERIFEyHCFCIxMoKS/9oADAMBAAIRAxEAPwB85kwIdPI/c3NZyVc68ot+TgHJmVHtFmhV0xqApFSbTj04FdiKA2+QI8Msipevy+pKXC1zGgEIWXbHe7Mfhj6js9Qh+IxHFcsti7aSUtctkKTSH1Ti5Fv35OpsW5Vo795zDk6V32y2hjZBuhbRtAdBvW4PS2RfqY5YY445Y9rHJZGbrmNNMgvG2O93gvFH09ZzEfhPHH5ks9ObbaJP52l4oIpyD7op8YcsJdNiB+v+W5IWE2cy6Q6a08cc5px6lvoMJT/3BNgOL1fX5vUhbrXR2IPv8x7KpCRyQy6muzsT71An2O2XQSa5W+JMEv76An9SvLjGePJPyH1soqS2iyCSUVNtX6ctZJBgCgWzKJGKmBRvxSKjwsezjwy7KeqBYbZaxFrbbokPHu8CgIfSkJpVvy3hv/rZN8hL0HQebsSjGP68UyCHVdHvDihS7bQevIHyB1uhJqXHWLgurB8MmjCwr6ZDCVTcT9z8ln5FurR37ubc2QhW/KVBGC5JN3ZYmOMnylqD7L9YbBQs3T4vSpaz9pOL927WPDIeFj5t/iTLx7dWkP3cG5uhCj6zPylhh2HyzIg4sr6NFCIGFP3vzQhC9JEKAIMMbYZkRf/Z",sudt_script_hash:"",address:"0x8290f27935A2D353adc834c9F3c5F6ef19635C2D",issuerLockHash:"0x13d640a864c7e84d60afd8ca9c6689d345a18f63e2e426c9623a2811776cf211",l1Lock:{code_hash:"0xc5e5dcf215925f7ef4dfaf5f4b4f105bc321c02776d6e7d52a1db3fcd9d011a4",hash_type:"type",args:"0x13d640a864c7e84d60afd8ca9c6689d345a18f63e2e426c9623a2811776cf211"}}];var A=n(63);function O(e){return function(t,n){if(!(n instanceof ArrayBuffer)){let a=BigInt(n).toString(16);if(a.length%2!==0&&(a="0"+a),a.length/2>e)throw new Error("".concat(t," is ").concat(a.length/2," bytes long, expected length is ").concat(e,"!"));const s=new DataView(new ArrayBuffer(e));for(let e=0;e<a.length/2;e++){const t=a.length-2*(e+1);s.setUint8(e,parseInt(a.substr(t,2),16))}n=s.buffer}if(n.byteLength<e){const t=new Uint8Array(e);t.set(new Uint8Array(n),0),n=t.buffer}return n}}function B(e){return function(t,n){if(n=new A.Reader(n).toArrayBuffer(),e>0&&n.byteLength!==e)throw new Error("".concat(t," has invalid length ").concat(n.byteLength,", required: ").concat(e));return n}}function z(e,t,n){const a={};for(const[s,i]of Object.entries(n)){const n=t[s];if(void 0===n||null===n)throw new Error("".concat(e," is missing ").concat(s,"!"));a[s]=i("".concat(e,".").concat(s),n)}return a}function I(e){return function(t,n){return e(n,{debugPath:t})}}function C(e){let{debugPath:t="fee"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return z(t,e,{sudt_id:O(4),amount:O(16)})}function S(e){let{debugPath:t="raw_withdrawal_request"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return z(t,e,{nonce:O(4),capacity:O(8),amount:O(16),sudt_script_hash:B(32),account_script_hash:B(32),sell_amount:O(16),sell_capacity:O(8),owner_lock_hash:B(32),payment_lock_hash:B(32),fee:I(C)})}const L={CKB_INDEXER_URL:"https://testnet.ckb.dev/indexer",CKB_RPC_URL:"https://testnet.ckb.dev",GW_POLYJUICE_RPC_URL:"https://godwoken-testnet-web3-rpc.ckbapp.dev"},U={CKB_INDEXER_URL:"https://testnet.ckb.dev/indexer",CKB_RPC_URL:"https://testnet.ckb.dev",GW_POLYJUICE_RPC_URL:"https://godwoken-testnet-web3-rpc.ckbapp.dev"};var N=n(370);function E(e,t){throw new Error("Invalid data length! Required: ".concat(t,", actual: ").concat(e))}function T(e,t){e!==t&&E(e,t)}function R(e){if(e instanceof Object&&e.toArrayBuffer instanceof Function&&(e=e.toArrayBuffer()),!(e instanceof ArrayBuffer))throw new Error("Provided value must be an ArrayBuffer or can be transformed into ArrayBuffer!");return e}function D(e){const t=e.length;let n=4*(t+1);const a=[];for(let o=0;o<t;o++)a.push(n),n+=e[o].byteLength;const s=new ArrayBuffer(n),i=new Uint8Array(s),r=new DataView(s);r.setUint32(0,n,!0);for(let o=0;o<t;o++)r.setUint32(4+4*o,a[o],!0),i.set(new Uint8Array(e[o]),a[o]);return s}function M(e){const t=new Uint8Array(0+H.size()+Q.size()+V.size()+X.size()+X.size()+V.size()+Q.size()+X.size()+X.size()+q.size());new DataView(t.buffer);return t.set(new Uint8Array(J(e.nonce)),0),t.set(new Uint8Array(K(e.capacity)),0+H.size()),t.set(new Uint8Array(Y(e.amount)),0+H.size()+Q.size()),t.set(new Uint8Array(Z(e.sudt_script_hash)),0+H.size()+Q.size()+V.size()),t.set(new Uint8Array(Z(e.account_script_hash)),0+H.size()+Q.size()+V.size()+X.size()),t.set(new Uint8Array(Y(e.sell_amount)),0+H.size()+Q.size()+V.size()+X.size()+X.size()),t.set(new Uint8Array(K(e.sell_capacity)),0+H.size()+Q.size()+V.size()+X.size()+X.size()+V.size()),t.set(new Uint8Array(Z(e.owner_lock_hash)),0+H.size()+Q.size()+V.size()+X.size()+X.size()+V.size()+Q.size()),t.set(new Uint8Array(Z(e.payment_lock_hash)),0+H.size()+Q.size()+V.size()+X.size()+X.size()+V.size()+Q.size()+X.size()),t.set(new Uint8Array(F(e.fee)),0+H.size()+Q.size()+V.size()+X.size()+X.size()+V.size()+Q.size()+X.size()+X.size()),t.buffer}function W(e){const t=[];return t.push(M(e.raw)),t.push($(e.signature)),D(t)}function P(e){const t=[];return t.push(Z(e.owner_lock_hash)),t.push(ee(e.layer2_lock)),t.push(K(e.cancel_timeout)),D(t)}function G(e){return D([])}class q{constructor(e){let{validate:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.view=new DataView(R(e)),t&&this.validate()}getSudtId(){return new H(this.view.buffer.slice(0,0+H.size()),{validate:!1})}getAmount(){return new V(this.view.buffer.slice(0+H.size(),0+H.size()+V.size()),{validate:!1})}validate(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];T(this.view.byteLength,q.size()),this.getSudtId().validate(e),this.getAmount().validate(e)}static size(){return 0+H.size()+V.size()}}function F(e){const t=new Uint8Array(0+H.size()+V.size());new DataView(t.buffer);return t.set(new Uint8Array(J(e.sudt_id)),0),t.set(new Uint8Array(Y(e.amount)),0+H.size()),t.buffer}class H{constructor(e){let{validate:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.view=new DataView(R(e)),t&&this.validate()}validate(){T(this.view.byteLength,4)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}toBigEndianUint32(){return this.view.getUint32(0,!1)}toLittleEndianUint32(){return this.view.getUint32(0,!0)}static size(){return 4}}function J(e){const t=R(e);return T(t.byteLength,4),t}class Q{constructor(e){let{validate:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.view=new DataView(R(e)),t&&this.validate()}validate(){T(this.view.byteLength,8)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}toBigEndianBigUint64(){return this.view.getBigUint64(0,!1)}toLittleEndianBigUint64(){return this.view.getBigUint64(0,!0)}static size(){return 8}}function K(e){const t=R(e);return T(t.byteLength,8),t}class V{constructor(e){let{validate:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.view=new DataView(R(e)),t&&this.validate()}validate(){T(this.view.byteLength,16)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 16}}function Y(e){const t=R(e);return T(t.byteLength,16),t}class X{constructor(e){let{validate:t=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.view=new DataView(R(e)),t&&this.validate()}validate(){T(this.view.byteLength,32)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 32}}function Z(e){const t=R(e);return T(t.byteLength,32),t}function $(e){const t=R(e),n=new Uint8Array(4+t.byteLength);return new DataView(n.buffer).setUint32(0,t.byteLength,!0),n.set(new Uint8Array(t),4),n.buffer}function ee(e){const t=[];t.push(Z(e.code_hash));const n=new DataView(new ArrayBuffer(1));return n.setUint8(0,e.hash_type),t.push(n.buffer),t.push($(e.args)),D(t)}class te{constructor(e){this.rpc=void 0,this.rpc=new A.RPC(e)}async rpcCall(e){const t="gw_"+e;for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return await this.rpc[t](...a)}async submitWithdrawalRequest(e){const t=new A.Reader(W(function(e){let{debugPath:t="withdrawal_request"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return z(t,e,{raw:I(S),signature:B(65)})}(e))).serializeJson();return await this.rpcCall("submit_withdrawal_request",t)}async getAccountIdByScriptHash(e){return await this.rpcCall("get_account_id_by_script_hash",e)}async getScriptHashByShortAddress(e){return await this.rpcCall("get_script_hash_by_short_address",e)}async getWithdrawal(e){return await this.rpcCall("get_withdrawal",e)}async getNonce(e){return await this.rpcCall("get_nonce",e)}async getLastSubmittedInfo(){return await this.rpcCall("get_last_submitted_info")}async getScriptHash(e){return await this.rpcCall("get_script_hash",e)}}var ne=n(373),ae=n.n(ne);function se(e,t){throw new Error("Invalid data length! Required: ".concat(t,", actual: ").concat(e))}function ie(e,t){e!==t&&se(e,t)}function re(e){if(e instanceof Object&&e.toArrayBuffer instanceof Function&&(e=e.toArrayBuffer()),!(e instanceof ArrayBuffer))throw new Error("Provided value must be an ArrayBuffer or can be transformed into ArrayBuffer!");return e}function oe(e){const t=e.length;let n=4*(t+1);const a=[];for(let o=0;o<t;o++)a.push(n),n+=e[o].byteLength;const s=new ArrayBuffer(n),i=new Uint8Array(s),r=new DataView(s);r.setUint32(0,n,!0);for(let o=0;o<t;o++)r.setUint32(4+4*o,a[o],!0),i.set(new Uint8Array(e[o]),a[o]);return s}function ce(e){const t=[];return t.push(function(e){const t=re(e);return ie(t.byteLength,21),t}(e.identity)),t.push(function(e){return oe(e.map((e=>function(e){const t=[],n=new DataView(new ArrayBuffer(1));return n.setUint8(0,e.mask),t.push(n.buffer),t.push(de(e.proof)),oe(t)}(e))))}(e.proofs)),oe(t)}function le(e){const t=[];return t.push(he(e.signature)),t.push(function(e){return e?ce(e):new ArrayBuffer(0)}(e.rc_identity)),t.push(he(e.preimage)),oe(t)}function de(e){const t=re(e),n=new Uint8Array(4+t.byteLength);return new DataView(n.buffer).setUint32(0,t.byteLength,!0),n.set(new Uint8Array(t),4),n.buffer}function pe(e){const t=re(e),n=new Uint8Array(4+t.byteLength);return new DataView(n.buffer).setUint32(0,t.byteLength,!0),n.set(new Uint8Array(t),4),n.buffer}function he(e){return e?pe(e):new ArrayBuffer(0)}const ue={web3Url:L.GW_POLYJUICE_RPC_URL,abiItems:[{inputs:[{internalType:"string",name:"name_",type:"string"},{internalType:"string",name:"symbol_",type:"string"},{internalType:"uint256",name:"totalSupply_",type:"uint256"},{internalType:"uint256",name:"sudtId_",type:"uint256"},{internalType:"uint8",name:"decimals_",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[],name:"sudtId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"},{internalType:"address",name:"spender",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}]},be=new N.PolyjuiceHttpProvider(ue.web3Url,ue);class ge{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AGGRON";if(this.l2Address="",this.l1Address="",this.ckbIndexer=void 0,this.rpc=void 0,this.ethereum=void 0,this.web3=void 0,this.godwokenClient=void 0,"AGGRON"===n)p.config.initializeConfig(p.config.predefined.AGGRON4),this.ckbIndexer=new p.Indexer(U.CKB_INDEXER_URL,U.CKB_RPC_URL),this.rpc=new p.RPC(U.CKB_RPC_URL),this.godwokenClient=new te(L.GW_POLYJUICE_RPC_URL);else{if("LINA"!==n)throw new Error("env not defined, please use AGGRON or LINA.");p.config.initializeConfig(p.config.predefined.LINA),this.ckbIndexer=new p.Indexer(L.CKB_INDEXER_URL,L.CKB_RPC_URL),this.rpc=new p.RPC(L.CKB_RPC_URL),this.godwokenClient=new te(L.GW_POLYJUICE_RPC_URL)}this.ethereum=t,this.l2Address=e,this.l1Address=this.generateL1Address(this.l2Address),t.on("accountsChanged",(e=>{console.log("eth accounts changed",e),this.l2Address=e[0],this.l1Address=this.generateL1Address(this.l2Address)})),this.web3=new ae.a(be)}async sendWithdrawTransaction(e){return await this.godwokenClient.submitWithdrawalRequest(e)}getL2Address(){return this.l2Address}getL1Address(){return this.l1Address}static async CreateProvider(e){if(!e||!e.isMetaMask)throw new Error("please provide metamask ethereum object");return e.request({method:"eth_requestAccounts"}).then((t=>(console.log("eth_requestAccounts",t),new ge(t[0],e)))).catch((e=>{4001===e.code?console.log("Please connect to MetaMask."):console.error(e)}))}generateL1Address(e){const t={code_hash:f.code_hash,hash_type:f.hash_type,args:"0x01".concat(e.substring(2),"00")};return p.helpers.generateAddress(t)}async sendL1Transaction(e){return await this.rpc.send_transaction(e,"passthrough")}async signL1Transaction(e){const t=this.generateMessage(e);let n=await this.ethereum.request({method:"personal_sign",params:[this.ethereum.selectedAddress,t]}),a=Number.parseInt(n.slice(-2),16);a>=27&&(a-=27),n="0x"+n.slice(2,-2)+a.toString(16).padStart(2,"0");const s=new p.toolkit.Reader(p.core.SerializeWitnessArgs({lock:le({signature:new p.toolkit.Reader(n)})})).serializeJson();e=e.update("witnesses",(e=>e.push("".concat(s))));return p.helpers.createTransactionFromSkeleton(e)}generateMessage(e){const t=new p.utils.CKBHasher,n=p.utils.ckbHash(p.core.SerializeRawTransaction(p.toolkit.normalizers.NormalizeRawTransaction(p.helpers.createTransactionFromSkeleton(e)))),a=p.core.SerializeWitnessArgs({lock:new p.toolkit.Reader("0x"+"00".repeat(le({signature:new p.toolkit.Reader("0x"+"00".repeat(65))}).byteLength))});return t.update(n),this.hashWitness(t,a),t.digestHex()}hashWitness(e,t){const n=new ArrayBuffer(8);new DataView(n).setBigUint64(0,BigInt(new p.toolkit.Reader(t).length()),!0),e.update(n),e.update(t)}async getPendingTransaction(e){let t=null;for(let n=0;n<10;n++){if(t=await this.rpc.get_transaction(e),null!=t)return t;await this.asyncSleep(1e3)}return null}async getRollupCellDep(){const e=(await this.godwokenClient.getLastSubmittedInfo()).transaction_hash,t=await this.getPendingTransaction(e);if(null==t)throw new Error("Last submitted tx not found!");let n=t.transaction.outputs.findIndex((e=>e.type&&p.utils.computeScriptHash(e.type)===_));return{out_point:{tx_hash:e,index:"0x".concat(n.toString(16))},dep_type:"code"}}async getRollupCell(){const e={type:{code_hash:v.code_hash,hash_type:v.hash_type,args:v.args}},t=this.ckbIndexer.collector(e);let n;for await(const a of t.collect()){if(null===a)return;n=a;break}return n}async getLastFinalizedBlockNumber(){const e=await this.getRollupCell();if(void 0===!e)return 0;const t=new h.core.GlobalState(new p.toolkit.Reader(e.data)),n=Number(t.getLastFinalizedBlockNumber().toLittleEndianBigUint64());return console.log("last finalized block number: ",n),n}async asyncSleep(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((t=>setTimeout(t,e)))}}class xe{constructor(e){this.provider=void 0,this.provider=e}async deposit(e){const t=BigInt(e.capacity),n=e.amount?BigInt(e.amount):BigInt(0);let a=BigInt(0),s=BigInt(0);const i=[],r=this.provider.ckbIndexer.collector({lock:p.helpers.parseAddress(this.provider.l1Address)});for await(const b of r.collect()){var o;if(b.data&&"0x"!==b.data&&"0x0"!==b.data){if(e.sudtType&&e.sudtType.args===(null===(o=b.cell_output.type)||void 0===o?void 0:o.args)&&(a+=BigInt(b.cell_output.capacity),s+=BigInt(p.utils.readBigUInt128LE(b.data)),i.push(b),a>=t&&s>=n))break}else if(a+=BigInt(b.cell_output.capacity),i.push(b),a>=t&&s>=n)break}if(a<t)throw new Error("Not enough CKB, expected: ".concat(t,", actual: ").concat(a," "));if(s<n)throw new Error("Not enough SUDT, expected: ".concat(n,", actual: ").concat(s," "));const c={out_point:{tx_hash:f.tx_hash,index:f.index},dep_type:f.dep_type},l={out_point:{tx_hash:m.tx_hash,index:m.index},dep_type:m.dep_type},d=this.generateDepositOutputCell(i,e);let h=p.helpers.TransactionSkeleton({cellProvider:this.provider.ckbIndexer});if(h=h.update("inputs",(e=>e.push(...i))).update("outputs",(e=>e.push(...d))).update("cellDeps",(e=>e.push(c))).update("cellDeps",(e=>e.push(l))),e.sudtType){const e={out_point:{tx_hash:j.tx_hash,index:j.index},dep_type:j.dep_type};h=h.update("cellDeps",(t=>t.push(e)))}const u=await this.provider.signL1Transaction(h);return await this.provider.sendL1Transaction(u)}generateDepositOutputCell(e,t){const n=p.helpers.parseAddress(this.provider.l1Address),a={owner_lock_hash:p.utils.computeScriptHash(n),layer2_lock:{code_hash:w.script_type_hash,hash_type:"type",args:_+this.provider.l2Address.slice(2).toLowerCase()},cancel_timeout:"0xc0000000000004b0"},s=new p.toolkit.Reader(P(function(e){let{debugPath:t="deposit_lock_args"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return z(t,e,{owner_lock_hash:B(32),layer2_lock:I(A.normalizers.NormalizeScript),cancel_timeout:O(8)})}(a))).serializeJson(),i={code_hash:x.script_type_hash,hash_type:"type",args:_+s.slice(2)},r=e.reduce(((e,t)=>e+BigInt(t.cell_output.capacity)),BigInt(0)),o=e.reduce(((e,t)=>t.cell_output.type?e+BigInt(p.utils.readBigUInt128LE(t.data)):e),BigInt(0)),c={cell_output:{capacity:"0x"+BigInt(t.capacity).toString(16),lock:i},data:"0x"},l={cell_output:{capacity:"0x"+BigInt(r-BigInt(t.capacity)-BigInt(1e5)).toString(16),lock:p.helpers.parseAddress(this.provider.l1Address)},data:"0x"};return t.sudtType&&t.amount&&"0x"!==t.amount&&"0x0"!==t.amount&&(c.cell_output.type=t.sudtType,c.data=p.utils.toBigUInt128LE(BigInt(t.amount)),l.cell_output.type=t.sudtType,l.data=p.utils.toBigUInt128LE(o-BigInt(t.amount))),[c,l]}getBlockProduceTime(){return 45e3}async unlock(e){const t=this.provider.l1Address,n=p.helpers.parseAddress(t),a=[];if(e.cell.cell_output.type){const t={cell_output:{capacity:"0x0",lock:n,type:e.cell.cell_output.type},data:e.cell.data},s=p.helpers.minimalCellCapacity(t),i=BigInt(e.cell.cell_output.capacity)-s;a.push({cell_output:{capacity:"0x".concat(i.toString(16)),lock:n},data:"0x"}),a.push({cell_output:{capacity:"0x".concat(s.toString(16)),lock:n,type:e.cell.cell_output.type},data:e.cell.data})}else a.push({cell_output:{capacity:e.cell.cell_output.capacity,lock:n,type:e.cell.cell_output.type},data:e.cell.data});const s={lock:"0x00000000"+new p.toolkit.Reader(G(p.toolkit.normalizers.NormalizeWitnessArgs({}))).serializeJson().slice(2)},i=new p.toolkit.Reader(p.core.SerializeWitnessArgs(p.toolkit.normalizers.NormalizeWitnessArgs(s))).serializeJson();let r=p.helpers.TransactionSkeleton({cellProvider:this.provider.ckbIndexer});const o={out_point:{tx_hash:f.tx_hash,index:f.index},dep_type:f.dep_type},c={out_point:{tx_hash:m.tx_hash,index:m.index},dep_type:m.dep_type},l={out_point:{tx_hash:y.cell_dep.out_point.tx_hash,index:y.cell_dep.out_point.index},dep_type:y.cell_dep.dep_type},d=await this.provider.getRollupCellDep();if(r=r.update("inputs",(t=>t.push(e.cell))).update("outputs",(e=>e.push(...a))).update("cellDeps",(e=>e.push(l))).update("cellDeps",(e=>e.push(d))).update("cellDeps",(e=>e.push(o))).update("cellDeps",(e=>e.push(c))).update("witnesses",(e=>e.push(i))),e.cell.cell_output.type){const e={out_point:{tx_hash:j.tx_hash,index:j.index},dep_type:j.dep_type};r=r.update("cellDeps",(t=>t.push(e)))}r=await this.injectCapacity(r,n,BigInt(0));const h=await this.provider.signL1Transaction(r);return await this.provider.sendL1Transaction(h)}async listWithdraw(){const e=this.getWithdrawalCellSearchParams(this.provider.l2Address);console.log("searchParams is:",e);const t=[],n=this.provider.ckbIndexer.collector({lock:e.script}),a=await this.provider.getLastFinalizedBlockNumber(),s=p.helpers.parseAddress(this.provider.l1Address),i={code_hash:s.code_hash,args:s.args,hash_type:s.hash_type},r=p.utils.computeScriptHash(i);for await(const c of n.collect()){const e=c.cell_output.lock.args,n=new h.core.WithdrawalLockArgs(new p.toolkit.Reader("0x".concat(e.slice(66))));if(null==n)continue;const s=Number(n.getWithdrawalBlockNumber().toLittleEndianBigUint64()),i=c.cell_output.lock.args.includes(r.substring(2));let o,l="0x"+"00".repeat(32),d="0x0";if(c.cell_output.type){const e={code_hash:c.cell_output.type.code_hash,args:c.cell_output.type.args,hash_type:c.cell_output.type.hash_type};l=p.utils.computeScriptHash(e);o=this.getBuiltinErc20List().find((e=>e.sudt_script_hash===l)),d="0x".concat(p.utils.readBigUInt128LE(c.data).toString(16))}i&&t.push({cell:c,withdrawalBlockNumber:s,remainingBlockNumber:Math.max(0,s-a),capacity:c.cell_output.capacity,amount:d,sudt_script_hash:l,erc20:o})}const o=t.sort(((e,t)=>e.withdrawalBlockNumber-t.withdrawalBlockNumber));return console.log("found withdraw cells:",o),o}getWithdrawalCellSearchParams(e){if(42!==e.length||!e.startsWith("0x"))throw new Error("eth address format error!");const t={code_hash:w.script_type_hash,hash_type:"type",args:_+e.slice(2).toLowerCase()},n=p.utils.computeScriptHash(t);return{script:{code_hash:y.script_type_hash,hash_type:"type",args:"".concat(_).concat(n.slice(2))},script_type:"lock"}}withdrawWithEvent(e){const t=new b.a;return this.withdraw(t,e),t}async withdraw(e,t){e.emit("sending");const n=_,a=w.script_type_hash;console.log(" helpers.parseAddress(payload.withdrawal_address || this.provider.l1Address)",t,this.provider);const s=p.helpers.parseAddress(t.withdrawal_address||this.provider.l1Address),i=p.utils.computeScriptHash(s),r={code_hash:a,hash_type:"type",args:n+this.provider.l2Address.slice(2)},o=p.utils.computeScriptHash(r);console.log("account script hash:",o);const c=await this.provider.godwokenClient.getAccountIdByScriptHash(o);if(!c)throw new Error("account not found");const l="0x0000000000000000000000000000000000000000000000000000000000000000"!==t.sudt_script_hash,d=this.minimalWithdrawalCapacity(l);if(BigInt(t.capacity)<BigInt(d))throw new Error("Withdrawal required ".concat(BigInt(d)," shannons at least, provided ").concat(BigInt(t.capacity),"."));const h=await this.provider.godwokenClient.getNonce(c);console.log("nonce:",h);const u="0x"+"00".repeat(32),b={nonce:"0x"+BigInt(h).toString(16),capacity:"0x"+BigInt(t.capacity).toString(16),amount:"0x"+BigInt(t.amount).toString(16),sudt_script_hash:t.sudt_script_hash,account_script_hash:o,sell_amount:"0x0",sell_capacity:"0x0",owner_lock_hash:i,payment_lock_hash:u,fee:{sudt_id:"0x1",amount:"0x0"}};console.log("rawWithdrawalRequest:",b);const g=this.generateWithdrawalMessageToSign(b,n);console.log("message:",g);const x=await this.signMessageMetamaskPersonalSign(g);console.log("signatureMetamaskPersonalSign:",x);const f={raw:b,signature:x};let y;console.log("withdrawalRequest:",f);try{y=await this.provider.godwokenClient.submitWithdrawalRequest(f)}catch(v){return void e.emit("error",v)}e.emit("sent",y),console.log("withdrawal request result:",y);let m=0;const j=setInterval((async()=>{m++;const t=await this.getWithdrawal(y);t&&"pending"===t.status&&(console.log("withdrawal pending:",t),e.emit("pending",y)),t&&"committed"===t.status&&(console.log("withdrawal committed:",t),e.emit("success",y),clearInterval(j)),null===t&&m>100&&(e.emit("fail",y),clearInterval(j))}),1e4)}async getWithdrawal(e){const t=await this.provider.godwokenClient.getWithdrawal(e);return console.log("getWithdrawal result:",t),t}async signMessageMetamaskPersonalSign(e){let t=await this.provider.ethereum.request({method:"personal_sign",params:[this.provider.l2Address,e]}),n=Number.parseInt(t.slice(-2),16);return n>=27&&(n-=27),t="0x"+t.slice(2,-2)+n.toString(16).padStart(2,"0"),t}async signMessageMetamaskEthSign(e){let t=await this.provider.ethereum.request({method:"eth_sign",params:[this.provider.l2Address,e]}),n=Number.parseInt(t.slice(-2),16);return n>=27&&(n-=27),t="0x"+t.slice(2,-2)+n.toString(16).padStart(2,"0"),t}signMessage(e,t){const n=g.ecdsaSign(new Uint8Array(new p.toolkit.Reader(e).toArrayBuffer()),new Uint8Array(new p.toolkit.Reader(t).toArrayBuffer())),a=new ArrayBuffer(65),s=new Uint8Array(a);s.set(n.signature,0);let i=n.recid;i>=27&&(i-=27),s.set([i],64);return new p.toolkit.Reader(a).serializeJson()}generateWithdrawalMessageToSign(e,t){const n=new p.toolkit.Reader(M(S(e))).serializeJson(),a=new p.toolkit.Reader(t+n.slice(2)).toArrayBuffer();return p.utils.ckbHash(a).serializeJson()}minimalWithdrawalCapacity(e){const t="0x"+"00".repeat(32),n="0x0",a=t,s={account_script_hash:t,withdrawal_block_hash:t,withdrawal_block_number:n,sudt_script_hash:t,sell_amount:n,sell_capacity:n,owner_lock_hash:t,payment_lock_hash:t},i=new p.toolkit.Reader(function(e){const t=new Uint8Array(0+X.size()+X.size()+Q.size()+X.size()+V.size()+Q.size()+X.size()+X.size());return new DataView(t.buffer),t.set(new Uint8Array(Z(e.account_script_hash)),0),t.set(new Uint8Array(Z(e.withdrawal_block_hash)),0+X.size()),t.set(new Uint8Array(K(e.withdrawal_block_number)),0+X.size()+X.size()),t.set(new Uint8Array(Z(e.sudt_script_hash)),0+X.size()+X.size()+Q.size()),t.set(new Uint8Array(Y(e.sell_amount)),0+X.size()+X.size()+Q.size()+X.size()),t.set(new Uint8Array(K(e.sell_capacity)),0+X.size()+X.size()+Q.size()+X.size()+V.size()),t.set(new Uint8Array(Z(e.owner_lock_hash)),0+X.size()+X.size()+Q.size()+X.size()+V.size()+Q.size()),t.set(new Uint8Array(Z(e.payment_lock_hash)),0+X.size()+X.size()+Q.size()+X.size()+V.size()+Q.size()+X.size()),t.buffer}(function(e){let{debugPath:t="withdrawal_lock_args"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return z(t,e,{account_script_hash:B(32),withdrawal_block_hash:B(32),withdrawal_block_number:O(8),sudt_script_hash:B(32),sell_amount:O(16),sell_capacity:O(8),owner_lock_hash:B(32),payment_lock_hash:B(32)})}(s))).serializeJson(),r={code_hash:t,hash_type:"data",args:a+i.slice(2)};let o,c="0x";e&&(o={code_hash:t,hash_type:"data",args:t},c="0x"+"00".repeat(16));const l={cell_output:{lock:r,type:o,capacity:n},data:c};return"0x"+p.helpers.minimalCellCapacity(l).toString(16)}async getL2CkbBalance(e){const t=await this.provider.web3.eth.getBalance((null===e||void 0===e?void 0:e.l2Address)||this.provider.l2Address);return"0x"+Number(t).toString(16)}async getL1CkbBalance(e){const t=this.provider.ckbIndexer.collector({lock:p.helpers.parseAddress(this.provider.l1Address)});let n=BigInt(0);for await(const a of t.collect())n+=BigInt(a.cell_output.capacity);return"0x"+n.toString(16)}getBuiltinErc20List(){const e=[];return k.forEach((t=>{const n={code_hash:t.l1Lock.code_hash,args:t.l1Lock.args,hash_type:t.l1Lock.hash_type},a=p.utils.computeScriptHash(n);e.push({name:t.name,symbol:t.symbol,decimals:t.decimals,address:t.address,tokenURI:t.tokenURI,sudt_script_hash:a})})),e}getBuiltinL1TokenList(){const e=[];return k.forEach((t=>{const n={code_hash:t.l1Lock.code_hash,args:t.l1Lock.args,hash_type:t.l1Lock.hash_type};e.push({type:n,name:t.name,symbol:t.symbol,decimals:t.decimals,tokenURI:t.tokenURI})})),e}async getErc20Balances(e){const t={balances:[]};let n=[];for(let a=0;a<e.addresses.length;a++){const t=e.addresses[a],s=new this.provider.web3.eth.Contract(ue.abiItems,t).methods.balanceOf(this.provider.l2Address).call();n.push(s)}return await Promise.all(n).then((e=>{e.forEach((e=>{t.balances.push("0x"+Number(e).toString(16))}))})),t}async getSudtBalances(e){const t={balances:[]};for(let n=0;n<e.types.length;n++){const a=e.types[n],s=this.provider.ckbIndexer.collector({lock:p.helpers.parseAddress(this.provider.l1Address),type:a});let i=BigInt(0);for await(const e of s.collect())i+=BigInt(p.utils.readBigUInt128LE(e.data));t.balances.push("0x"+i.toString(16))}return t}async injectCapacity(e,t,n){const a=n+BigInt(1e5);let s=BigInt(0);const i=[],r=this.provider.ckbIndexer.collector({lock:t,type:"empty"});for await(const c of r.collect())if((!c.data||"0x"===c.data||"0x0"===c.data||"0x00"===c.data)&&(s+=BigInt(c.cell_output.capacity),i.push(c),s>=a))break;if(s<a)throw new Error("Not enough CKB, expected: ".concat(a,", actual: ").concat(s," "));const o={cell_output:{capacity:"0x"+BigInt(s-a).toString(16),lock:t},data:"0x"};return e=(e=e.update("inputs",(e=>e.push(...i)))).update("outputs",(e=>e.push(o)))}}var fe=n(1);const ye=Object(a.createContext)(null),we=e=>{const[t,n]=Object(a.useState)();return Object(a.useEffect)((()=>{d()().then((e=>{e.request({method:"eth_accounts"}).then((t=>{if(!t||!t[0])return;const a=new xe(new ge(t[0],e));n(a)})),e.on("accountsChanged",(t=>{if(!t||!t[0])return n(void 0);const a=new xe(new ge(e.selectedAddress,e));n(a)}))}))}),[]),Object(fe.jsx)(ye.Provider,{value:t||null,children:e.children})};var me=n(19),je=n(829),_e=n(830),ve=n(831),ke=n(825),Ae=n(826),Oe=n(397),Be=n(97),ze=n(20);const Ie=()=>Object(a.useContext)(ye),Ce=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=e.toString();if(0===t)return n;const a=n.slice(0,-t)||"0",s="0"===a?1e8:1e4;let i=n.slice(-t).padStart(t,"0").slice(0,"0"===a?9:5);return i=(Math.round(Number("0.".concat(i))*s)/s).toFixed("0"===a?8:4).replace(/(\d)0+$/,"$1").slice(2),"".concat(a).concat("0"===i?"":".".concat(i))},Se=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{maxDecimalPlace:a=4}=n,s=e.toString();if(0===t)return s;const i=s.slice(0,-t)||"0",r=s.slice(-t).padStart(t,"0").replace(/(\d)0+$/,"$1").slice(0,a);return"".concat(i).concat("0"===r?"":".".concat(r))};var Le;const Ue=ze.a.input(Le||(Le=Object(me.a)(["\n  width: 0;\n  position: relative;\n  font-weight: 500;\n  outline: none;\n  border: none;\n  flex: 1 1 auto;\n  background-color: transparent;\n  font-size: 16px;\n  text-align: ",';\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 0px;\n  -webkit-appearance: textfield;\n\n  ::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n\n  [type="number"] {\n    -moz-appearance: textfield;\n  }\n\n  ::-webkit-outer-spin-button,\n  ::-webkit-inner-spin-button {\n    -webkit-appearance: none;\n  }\n\n  :disabled {\n    cursor: text;\n  }\n'])),(e=>{let{align:t}=e;return t&&t}));const Ne=RegExp("^\\d*(?:\\\\[.])?\\d*$");var Ee,Te,Re=s.a.memo((function(e){let{value:t,onUserInput:n,placeholder:a,...s}=e;return Object(fe.jsx)(Ue,{...s,value:t,onChange:e=>{var t;(""===(t=e.target.value.replace(/,/g,"."))||Ne.test(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")))&&n(t)},inputMode:"decimal",title:"Token Amount",autoComplete:"off",autoCorrect:"off",type:"text",pattern:"^[0-9]*[.,]?[0-9]*$",placeholder:a||"0.0",minLength:1,maxLength:79,spellCheck:"false"})}));const De=ze.a.div(Ee||(Ee=Object(me.a)(["\n  font-size: 14px;\n  border-radius: 16px;\n  background-color: rgb(60, 58, 75);\n  box-shadow: rgb(74 74 104 / 10%) 0px 2px 2px -1px;\n  .first-row {\n    margin-bottom: 3px;\n    padding: 0.75rem 1rem 0px;\n  }\n  .anticon {\n    font-size: 12px;\n  }\n\n  .input-wrapper {\n    padding: 0.75rem 0.5rem 0.75rem 1rem;\n  }\n"]))),Me=ze.a.div(Te||(Te=Object(me.a)(["\n  display: flex;\n  justify-content: space-between;\n  .ant-typography {\n    color: white;\n    font-size: 16px;\n    font-weight: 400;\n    line-height: 1.5;\n  }\n  .ckb-logo {\n    height: 24px;\n    width: 24px;\n    margin-right: 8px;\n  }\n  .max-button {\n    height: 32px;\n    padding: 0px 16px;\n    background-color: transparent;\n    color: rgb(255, 67, 66);\n    font-weight: 600;\n    &:hover {\n      cursor: pointer;\n    }\n  }\n"])));function We(e){let{value:t,onUserInput:n,label:s,isL1:i}=e;const[r,o]=Object(a.useState)(!0),[c,l]=Object(a.useState)(""),d=Ie();Object(a.useEffect)((()=>{(async()=>{const e=i?await(null===d||void 0===d?void 0:d.getL1CkbBalance())||"":await(null===d||void 0===d?void 0:d.getL2CkbBalance())||"";l(e)})()}),[d,i]),Object(a.useEffect)((()=>{t!==Ce(BigInt(c),8)?o(!0):o(!1)}),[t,c]);return Object(fe.jsxs)(De,{children:[Object(fe.jsxs)(Me,{className:"first-row",children:[Object(fe.jsx)(ke.a.Text,{children:s}),Object(fe.jsxs)(ke.a.Text,{children:["Balance: ",Ce(BigInt(c),8)||""]})]}),Object(fe.jsxs)(Me,{className:"input-wrapper",children:[Object(fe.jsx)(Re,{className:"token-amount-input",value:t,placeholder:"Minimum 400 CKB",onUserInput:e=>{n(e)}}),r&&Object(fe.jsx)(ke.a.Text,{className:"max-button",onClick:()=>{n(Ce(BigInt(c),8)),o(!1)},children:"MAX"}),Object(fe.jsx)("img",{className:"ckb-logo",src:"./static/ckb.svg",alt:""}),Object(fe.jsx)(ke.a.Text,{children:"CKB"})]})]})}var Pe=n(824),Ge=n(828),qe=n(399);const Fe=3600,He=86400,Je=2629800,Qe=31557600;var Ke,Ve,Ye,Xe,Ze,$e=e=>{let t=Math.abs(e);const n={years:0,months:0,days:0,hours:0,minutes:0,seconds:0};return t>=Qe&&(n.years=Math.floor(t/Qe),t-=n.years*Qe),t>=Je&&(n.months=Math.floor(t/Je),t-=n.months*Je),t>=He&&(n.days=Math.floor(t/He),t-=n.days*He),t>=Fe&&(n.hours=Math.floor(t/Fe),t-=n.hours*Fe),t>=60&&(n.minutes=Math.floor(t/60),t-=60*n.minutes),n.seconds=Math.floor(t),n};const{Text:et}=ke.a,tt=ze.a.div(Ke||(Ke=Object(me.a)(["\n  background: rgb(39, 37, 52);\n  padding: 16px;\n  border-radius: 12px;\n  .header {\n    display: flex;\n    flex-direction: row;\n    justify-content: space-between;\n    font-weight: 400;\n    line-height: 1.5;\n    font-size: 14px;\n  }\n  .icons {\n    display: flex;\n    img {\n      width: 20px;\n      height: 20px;\n      margin-right: 5px;\n    }\n  }\n  .ckb-icon {\n    width: 20px;\n    height: 20px;\n    background: url(./static/ckb.svg) no-repeat no-repeat;\n    background-size: contain;\n  }\n  .number {\n    margin-top: 3px;\n  }\n  .time {\n    align-self: center;\n    display: flex;\n    height: 40px;\n    align-items: center;\n    .ant-typography {\n      padding-right: 5px;\n    }\n  }\n  .ant-typography {\n    color: white;\n  }\n  .list-detail {\n    padding-top: 10px;\n  }\n"]))),nt=Object(ze.a)(Be.a)(Ve||(Ve=Object(me.a)(["\n  align-items: center;\n  border: 0px;\n  border-radius: 16px;\n  box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;\n  cursor: pointer;\n  display: inline-flex;\n  font-family: inherit;\n  font-size: 16px;\n  font-weight: 600;\n  -webkit-box-pack: center;\n  justify-content: center;\n  letter-spacing: 0.03em;\n  line-height: 1;\n  opacity: 1;\n  outline: 0px;\n  transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;\n  height: 32px;\n  padding: 0px 16px;\n  background-color: rgb(255, 67, 66);\n  color: white;\n  margin-left: 4px;\n  margin-top: 8px;\n  &:hover,\n  &:focus,\n  &:active {\n    background-color: rgb(255, 67, 66);\n    color: white;\n  }\n"]))),at=ze.a.div(Ye||(Ye=Object(me.a)(["\n  align-items: center;\n  border: 0px;\n  border-radius: 16px;\n  box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;\n  cursor: pointer;\n  display: inline-flex;\n  font-family: inherit;\n  font-size: 16px;\n  font-weight: 600;\n  -webkit-box-pack: center;\n  justify-content: center;\n  letter-spacing: 0.03em;\n  line-height: 1;\n  opacity: 1;\n  outline: 0px;\n  transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;\n  height: 32px;\n  padding: 0px 16px;\n  background-color: rgb(60, 58, 75);\n  color: white;\n  margin-left: 4px;\n  margin-top: 8px;\n  &:hover,\n  &:focus,\n  &:active {\n    background-color: rgb(60, 58, 75);\n    color: white;\n  }\n"]))),st=ze.a.div(Xe||(Xe=Object(me.a)(["\n  height: 24px;\n  display: flex;\n  justify-content: space-between;\n  .ant-typography {\n    color: white;\n    font-size: 16px;\n    font-weight: 400;\n    line-height: 1.5;\n  }\n"]))),it=Object(ze.a)(Ae.a)(Ze||(Ze=Object(me.a)(["\n  color: white;\n  .ant-modal-content {\n    border-radius: 32px;\n    background: rgb(39, 37, 52);\n    box-shadow: rgb(14 14 44 / 10%) 0px 20px 36px -8px, rgb(0 0 0 / 5%) 0px 1px 1px;\n    border: 1px solid rgb(60, 58, 75);\n    color: white;\n  }\n  .ant-modal-header {\n    background: rgb(39, 37, 52);\n    border: 1px solid rgb(60, 58, 75);\n    border-top-left-radius: 32px;\n    border-top-right-radius: 32px;\n    padding: 12px 24px;\n    height: 73px;\n    display: flex;\n    align-items: center;\n  }\n  .ant-modal-title {\n    color: white;\n  }\n  .ant-modal-body {\n    padding: 20px;\n  }\n  .ant-modal-close-x {\n    color: white;\n  }\n  .ant-typography {\n    color: white;\n    display: block;\n  }\n  .ant-typography.title {\n    font-size: 20px;\n    padding-bottom: 10px;\n  }\n  .actions {\n    padding-top: 20px;\n    display: flex;\n    justify-content: center;\n  }\n  .confirm {\n    margin-left: 30px;\n  }\n  .confirm,\n  .cancel {\n    border-radius: 6px;\n  }\n"])));var rt,ot,ct,lt,dt=e=>{let{remainingBlockNumber:t,capacity:n,amount:s,erc20:i,now:r=0,cell:o}=e;const[c,l]=Object(a.useState)(!1),[d,p]=Object(a.useState)(0),[h,u]=Object(a.useState)(!1),[b,g]=Object(a.useState)(!1),x=Ie(),f=Object(a.useCallback)((()=>{l((e=>!e))}),[]);Object(a.useEffect)((()=>{(async()=>{const e=await(null===x||void 0===x?void 0:x.getBlockProduceTime())||0;p(e)})()}),[x]);const y=Object(a.useMemo)((()=>Date.now()+t*d),[d,t]),w=Object(a.useMemo)((()=>Math.max(0,y-r)),[r,y]),m=Object(a.useMemo)((()=>0===t),[t]),{days:j,hours:_,minutes:v,seconds:k}=Object(a.useMemo)((()=>$e(w/1e3)),[w]),[A,O]=Object(a.useMemo)((()=>{if("0"===n)return console.error("[warn] a withdrawal request cell with zero capacity"),["",""];const e=BigInt(n);return["".concat(Ce(e,8)," CKB"),"".concat(Se(e,8)," CKB")]}),[n]),[B,z]=Object(a.useMemo)((()=>{if(""===s||!i)return["",""];const e=BigInt(s);return["".concat(Ce(e,i.decimals)," ").concat(i.symbol),"".concat(Se(e,i.decimals)," ").concat(i.symbol)]}),[s,i]),I=()=>{u(!1)};return Object(fe.jsxs)(tt,{onClick:m?void 0:f,children:[Object(fe.jsxs)("div",{className:"header",children:[Object(fe.jsxs)("div",{className:"amount",children:[Object(fe.jsxs)("div",{className:"icons",children:[null!==i&&void 0!==i&&i.tokenURI?Object(fe.jsx)("img",{src:null===i||void 0===i?void 0:i.tokenURI,alt:""}):"",Object(fe.jsx)("div",{className:"ckb-icon"})]}),Object(fe.jsxs)("div",{className:"number",children:[B,""===B?"":" and ",A]})]}),m?Object(fe.jsx)(nt,{className:"withdraw-button",onClick:()=>{u(!0)},children:"withdraw"}):c?Object(fe.jsx)("div",{className:"time",children:Object(fe.jsx)(Ge.a,{})}):Object(fe.jsxs)("div",{className:"time",children:[Object(fe.jsx)(et,{title:"Estimated time left",children:j>0?"".concat(j).concat(j>1?" days":" day"):"".concat(_>0?"".concat(_.toString().padStart(2,"0"),":"):"").concat(v.toString().padStart(2,"0"),":").concat(k.toString().padStart(2,"0"))}),Object(fe.jsx)(qe.a,{})]})]}),c&&Object(fe.jsxs)("div",{className:"list-detail",children:[Object(fe.jsxs)(st,{children:[Object(fe.jsx)(et,{children:"Blocks remaining:"}),Object(fe.jsx)(et,{children:t})]}),Object(fe.jsxs)(st,{children:[Object(fe.jsx)(et,{children:"Estimated time left:"}),Object(fe.jsx)(et,{children:"".concat(j>0?"".concat(j).concat(j>1?" days ":" day "):"").concat(_.toString().padStart(2,"0"),":").concat(v.toString().padStart(2,"0"),":").concat(k.toString().padStart(2,"0"))})]})]}),Object(fe.jsxs)(it,{title:"Withdraw to Wallet",visible:h,onOk:()=>{u(!1)},onCancel:I,footer:null,children:[Object(fe.jsx)(et,{className:"title",children:"Confirm Unlock Withdrawal to below address"}),Object(fe.jsx)(et,{children:null===x||void 0===x?void 0:x.provider.getL1Address()}),Object(fe.jsxs)("div",{className:"actions",children:[Object(fe.jsx)(at,{className:"cancel",onClick:I,children:"Cancel"}),Object(fe.jsx)(nt,{className:"confirm",onClick:async()=>{g(!0);const e=await(null===x||void 0===x?void 0:x.unlock({cell:o}));g(!1);u(!1),Oe.a.success({message:"Unlock Tx(".concat(e,") is successful"),onClick:()=>{window.open("https://explorer.nervos.org/aggron/transaction/".concat(e),"_blank")}})},loading:b,children:"Confirm"})]})]})]})};const{Text:pt}=ke.a,ht=ze.a.div(rt||(rt=Object(me.a)(["\n  border-radius: 16px;\n  background-color: rgb(60, 58, 75);\n  box-shadow: rgb(74 74 104 / 10%) 0px 2px 2px -1px;\n  .first-row {\n    margin-bottom: 3px;\n  }\n  .anticon {\n    font-size: 12px;\n  }\n  .max-button {\n    height: 32px;\n    line-height: 32px;\n    padding: 0px 16px;\n    background-color: transparent;\n    color: rgb(255, 67, 66);\n    font-weight: 600;\n  }\n  .token-list {\n    height: 390px;\n    overflow-y: auto;\n  }\n  .first-row {\n    margin-bottom: 3px;\n    padding: 0.75rem 1rem 0px;\n  }\n  .input-wrapper {\n    height: 56px;\n    padding: 0.75rem 0.5rem 0.75rem 1rem;\n    display: flex;\n    align-items: center;\n  }\n  .currency-wrapper {\n    display: flex;\n    align-items: center;\n  }\n  .anticon {\n    margin-left: 10px;\n  }\n"]))),ut=ze.a.div(ot||(ot=Object(me.a)(["\n  height: 390px;\n  overflow-y: auto;\n"]))),bt=Object(ze.a)(Ae.a)(ct||(ct=Object(me.a)(["\n  color: white;\n  .ant-modal-content {\n    border-radius: 32px;\n    background: rgb(39, 37, 52);\n    box-shadow: rgb(14 14 44 / 10%) 0px 20px 36px -8px, rgb(0 0 0 / 5%) 0px 1px 1px;\n    border: 1px solid rgb(60, 58, 75);\n    color: white;\n  }\n  .ant-modal-header {\n    background: rgb(39, 37, 52);\n    border: 1px solid rgb(60, 58, 75);\n    border-top-left-radius: 32px;\n    border-top-right-radius: 32px;\n    padding: 12px 24px;\n    height: 73px;\n    display: flex;\n    align-items: center;\n  }\n  .ant-modal-title,\n  .ant-list-item {\n    color: white;\n  }\n  .ant-modal-body {\n    padding: 0px;\n  }\n  .ant-modal-close-x {\n    color: white;\n  }\n  .ant-list-item {\n    border-bottom: none;\n    padding: 4px 20px;\n    height: 56px;\n    &:hover {\n      background-color: rgb(60, 58, 75);\n      cursor: pointer;\n    }\n    &.selected {\n      background-color: rgb(60, 58, 75);\n    }\n  }\n  .currency-item {\n    width: 100%;\n    .info {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n    .icon {\n      width: 24px;\n      height: 24px;\n      margin-right: 10px;\n    }\n    .symbol-name {\n      display: flex;\n      flex-direction: column;\n      .symbol {\n        font-size: 16px;\n        font-weight: 600;\n        line-height: 1.5;\n      }\n      .name {\n        font-size: 14px;\n        line-height: 1.5;\n      }\n    }\n  }\n"]))),gt=ze.a.div(lt||(lt=Object(me.a)(["\n  display: flex;\n  justify-content: space-between;\n  .ant-typography {\n    color: white;\n    font-size: 16px;\n    font-weight: 400;\n    line-height: 1.5;\n  }\n  .ckb-logo {\n    height: 24px;\n    width: 24px;\n    margin-right: 8px;\n  }\n  .max-button {\n    height: 32px;\n    padding: 0px 16px;\n    background-color: transparent;\n    color: rgb(255, 67, 66);\n    font-weight: 600;\n  }\n"])));function xt(e){let{autoFocus:t,disableInput:n,value:s,onUserInput:i,label:r,isL1:o,onSelectedChange:c}=e;const[l,d]=Object(a.useState)(""),[p,h]=Object(a.useState)(!1),[u,b]=Object(a.useState)(),[g,x]=Object(a.useState)([]),[f,y]=Object(a.useState)(),[w,m]=Object(a.useState)(),j=Ie(),[_,v]=Object(a.useState)(!1);Object(a.useEffect)((()=>{(async()=>{if(j)if(o){const e=j.getBuiltinL1TokenList();b(e);const t=e.map((e=>e.type)),n=await j.getSudtBalances({types:t});x(n.balances)}else{const e=j.getBuiltinErc20List();b(e);const t=e.map((e=>e.address)),n=await j.getErc20Balances({addresses:t});x(n.balances)}})()}),[j,o]),Object(a.useEffect)((()=>{h(!(!f||s===l&&""!==s))}),[s,l,f]),Object(a.useEffect)((()=>{if(g&&g.length&&void 0!==w&&f){const e=g[w],t=Se(BigInt(e),f.decimals);d(t)}}),[w,g,f]);return Object(fe.jsxs)(ht,{children:[Object(fe.jsxs)(gt,{className:"first-row",children:[Object(fe.jsx)(ke.a.Text,{children:r}),Object(fe.jsx)(ke.a.Text,{children:l||""})]}),Object(fe.jsxs)(gt,{className:"input-wrapper",children:[Object(fe.jsx)(Re,{autoFocus:t,disabled:n,className:"token-amount-input",value:s,onUserInput:e=>{i(e)}}),p&&Object(fe.jsx)("div",{className:"max-button",onClick:()=>{i(l),h(!1)},children:"MAX"}),Object(fe.jsxs)("div",{className:"currency-wrapper",onClick:()=>{v(!0)},children:[f?Object(fe.jsxs)("div",{className:"currency-icon",children:[Object(fe.jsx)("img",{className:"ckb-logo",src:f.tokenURI,alt:""}),Object(fe.jsx)(ke.a.Text,{children:f.symbol})]}):Object(fe.jsx)(pt,{children:"Select a currency "}),Object(fe.jsx)(qe.a,{})]})]}),Object(fe.jsx)(bt,{title:"Select a Token",visible:_,onOk:()=>{v(!1)},onCancel:()=>{v(!1)},footer:null,children:Object(fe.jsx)(ut,{className:"token-list",children:Object(fe.jsx)(Pe.b,{dataSource:u,renderItem:(e,t)=>Object(fe.jsx)(Pe.b.Item,{className:e.symbol===(null===f||void 0===f?void 0:f.symbol)?"selected":"",onClick:()=>((e,t)=>{y(t),c(t),v(!1),h(!0),i(""),m(e)})(t,e),children:Object(fe.jsxs)(st,{className:"currency-item",children:[Object(fe.jsxs)("div",{className:"info",children:[Object(fe.jsx)("img",{className:"icon",src:e.tokenURI,alt:""}),Object(fe.jsxs)("div",{className:"symbol-name",children:[Object(fe.jsx)(pt,{className:"symbol",children:e.symbol}),Object(fe.jsx)(pt,{className:"name",children:e.name})]})]}),Object(fe.jsx)("div",{children:g.length?Se(BigInt(g[t]),e.decimals):""})]})})})})})]})}var ft,yt=n(398),wt=n(206),mt=n(827);const jt=ze.a.div(ft||(ft=Object(me.a)(["\n  color: #fff;\n  .text-pair {\n    display: flex;\n    justify-content: space-between;\n  }\n"])));function _t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;return e.substring(0,t)+"..."+e.substring(e.length-n)}const vt=()=>{const e=Ie(),t=Object(a.useMemo)((()=>{if(e)return e.provider.getL2Address()}),[e]);return e&&t?Object(fe.jsx)(wt.a,{title:Object(fe.jsxs)(jt,{children:[Object(fe.jsxs)("div",{className:"address-content",children:[Object(fe.jsx)("label",{htmlFor:"",children:"ETH ADDRESS"}),Object(fe.jsxs)(mt.a.Group,{compact:!0,children:[Object(fe.jsx)(mt.a,{style:{width:"calc(100% - 33px)"},value:e.provider.getL2Address()}),Object(fe.jsx)(wt.a,{title:"copy git url",children:Object(fe.jsx)(Be.a,{icon:Object(fe.jsx)(yt.a,{})})})]})]}),Object(fe.jsxs)("div",{className:"address-content",children:[Object(fe.jsx)("label",{htmlFor:"",children:"L1 WALLET ADDRESS"}),Object(fe.jsxs)(mt.a.Group,{compact:!0,children:[Object(fe.jsx)(mt.a,{style:{width:"calc(100% - 33px)"},value:e.provider.getL1Address()}),Object(fe.jsx)(wt.a,{title:"copy git url",children:Object(fe.jsx)(Be.a,{icon:Object(fe.jsx)(yt.a,{})})})]})]})]}),children:_t(t)}):null};var kt;const At=Object(ze.a)(Be.a)(kt||(kt=Object(me.a)(["\n  &.ant-btn-primary {\n    background: rgb(60, 58, 75);\n    border: none;\n  }\n"]))),Ot=()=>{const e=Ie();return Object(fe.jsx)(At,{type:"primary",onClick:function(){e||d()().then((e=>{e.request({method:"eth_requestAccounts"})}))},children:e?Object(fe.jsx)(vt,{}):"Connect"})};var Bt;const zt=ze.a.div(Bt||(Bt=Object(me.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  width: 100%;\n  padding: 16px;\n  background: radial-gradient(89.56% 89.56% at 50.04% 10.44%, rgb(60, 58, 75) 0%, rgb(28, 27, 37) 92.56%);\n  margin-bottom: 20px;\n  color: white;\n  .address:hover {\n    cursor: pointer;\n  }\n  a + a {\n    padding-left: 10px;\n  }\n"])));var It,Ct=()=>Object(fe.jsxs)(zt,{children:[Object(fe.jsxs)("div",{className:"link",children:[Object(fe.jsx)(o.b,{to:"/deposit",children:"Deposit"}),Object(fe.jsx)(o.b,{to:"/",children:"Withdrawal"})]}),Object(fe.jsx)("div",{className:"title",children:"Light Godwoken"}),Object(fe.jsx)("div",{className:"address",children:Object(fe.jsx)(Ot,{})})]});const St=ze.a.div(It||(It=Object(me.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  width: 100%;\n  min-height: calc(100vh);\n  background: radial-gradient(89.56% 89.56% at 50.04% 10.44%, rgb(60, 58, 75) 0%, rgb(28, 27, 37) 92.56%);\n"])));var Lt,Ut,Nt,Et,Tt,Rt=e=>{let{children:t,...n}=e;return Object(fe.jsxs)(St,{...n,children:[Object(fe.jsx)(Ct,{}),t]})};const{Text:Dt}=ke.a,Mt=ze.a.div(Lt||(Lt=Object(me.a)(["\n  width: 436px;\n  background: rgb(39, 37, 52);\n  border-radius: 24px;\n  color: white;\n"]))),Wt=ze.a.div(Ut||(Ut=Object(me.a)(["\n  display: flex;\n  justify-content: space-between;\n  padding: 24px;\n  align-items: center;\n  a,\n  .ant-typography {\n    color: white;\n  }\n"]))),Pt=ze.a.div(Nt||(Nt=Object(me.a)(["\n  padding: 24px;\n  grid-auto-rows: auto;\n  row-gap: 8px;\n  .icon {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    padding-top: 8px;\n    padding-bottom: 8px;\n  }\n"]))),Gt=ze.a.div(Et||(Et=Object(me.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  .submit-button {\n    align-items: center;\n    border: 0px;\n    border-radius: 16px;\n    box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;\n    cursor: pointer;\n    display: inline-flex;\n    font-family: inherit;\n    font-size: 16px;\n    font-weight: 600;\n    -webkit-box-pack: center;\n    justify-content: center;\n    letter-spacing: 0.03em;\n    line-height: 1;\n    opacity: 1;\n    outline: 0px;\n    transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;\n    height: 48px;\n    padding: 0px 24px;\n    background-color: rgb(255, 67, 66);\n    color: white;\n    width: 100%;\n    &:disabled {\n      background-color: rgb(60, 55, 66);\n      border-color: rgb(60, 55, 66);\n      box-shadow: none;\n      color: rgb(104, 102, 123);\n      cursor: not-allowed;\n    }\n  }\n  button:hover {\n    cursor: pointer;\n  }\n"]))),qt=Object(ze.a)(Ae.a)(Tt||(Tt=Object(me.a)(["\n  color: white;\n  .ant-modal-content {\n    border-radius: 32px;\n    background: rgb(39, 37, 52);\n    box-shadow: rgb(14 14 44 / 10%) 0px 20px 36px -8px, rgb(0 0 0 / 5%) 0px 1px 1px;\n    border: 1px solid rgb(60, 58, 75);\n    color: white;\n  }\n  .ant-modal-header {\n    background: rgb(39, 37, 52);\n    border: 1px solid rgb(60, 58, 75);\n    border-top-left-radius: 32px;\n    border-top-right-radius: 32px;\n    padding: 12px 24px;\n    height: 73px;\n    display: flex;\n    align-items: center;\n  }\n  .ant-modal-title,\n  .ant-list-item {\n    color: white;\n  }\n  .ant-modal-body {\n    padding: 24px;\n  }\n  .ant-modal-close-x {\n    color: white;\n  }\n  .ant-typography {\n    color: white;\n    justify-content: space-between;\n  }\n  .text-pair {\n    padding-top: 5px;\n    display: flex;\n    justify-content: space-between;\n    font-size: 24px;\n  }\n  .tips {\n    margin: 24px 0;\n  }\n"])));function Ft(){const[e,t]=Object(a.useState)(""),[n,s]=Object(a.useState)(""),[i,r]=Object(a.useState)(!1),[c,l]=Object(a.useState)(!1),[d,p]=Object(a.useState)(!0),[h,u]=Object(a.useState)(),b=Ie();Object(a.useEffect)((()=>{Number(e)>=400?p(!1):p(!0)}),[e]);return Object(fe.jsxs)(Rt,{children:[Object(fe.jsxs)(Mt,{children:[Object(fe.jsxs)(Wt,{className:"header",children:[Object(fe.jsx)(o.b,{to:"/",children:Object(fe.jsx)(je.a,{})}),Object(fe.jsx)(Dt,{children:"Request Withdrawal"}),Object(fe.jsx)(_e.a,{})]}),Object(fe.jsxs)(Pt,{className:"main",children:[Object(fe.jsx)(We,{value:e,onUserInput:t,label:"Withdraw"}),Object(fe.jsx)("div",{className:"icon",children:Object(fe.jsx)(ve.a,{})}),Object(fe.jsx)(xt,{value:n,onUserInput:s,label:"sUDT(optional)",onSelectedChange:e=>{u(e)}}),Object(fe.jsx)(Gt,{children:Object(fe.jsx)(Be.a,{className:"submit-button",disabled:d,onClick:()=>{r(!0)},children:"Request Withdrawal"})})]}),Object(fe.jsx)("div",{className:"footer"})]}),Object(fe.jsxs)(qt,{title:"Confirm Request",visible:i,onCancel:()=>{r(!1)},footer:null,children:[Object(fe.jsxs)("div",{className:"text-pair",children:[Object(fe.jsx)(Dt,{children:"Block wait"}),Object(fe.jsx)(Dt,{children:"10000"})]}),Object(fe.jsxs)("div",{className:"text-pair",children:[Object(fe.jsx)(Dt,{children:"Estimated time"}),Object(fe.jsx)(Dt,{children:"5 days"})]}),Object(fe.jsx)("div",{className:"tips",children:"Layer 2 assets will be locked in Withdrawal Request, available to withdraw to Layer 1 after maturity. Request Withdrawal"}),Object(fe.jsx)(Gt,{children:Object(fe.jsx)(Be.a,{className:"submit-button",loading:c,onClick:()=>{l(!0);const t=BigInt(e)*BigInt(Math.pow(10,8));let a,s="0x0",i="0x0000000000000000000000000000000000000000000000000000000000000000";if(h&&(s="0x"+BigInt(Number(n)*Math.pow(10,h.decimals)).toString(16),i=h.sudt_script_hash),b){try{a=b.withdrawWithEvent({capacity:"0x"+t.toString(16),amount:s,sudt_script_hash:i})}catch(a){return void console.log("withdrawal error:",a)}a.on("sent",(e=>{r(!1),Oe.a.info({message:"Withdrawal Tx(".concat(e,") has sent")}),l(!1)})),a.on("pending",(e=>{console.log("pending triggerd",e)})),a.on("success",(e=>{r(!1),Oe.a.success({message:"Withdrawal Tx(".concat(e,") is successful")})})),a.on("error",(e=>{l(!1),Oe.a.error({message:e instanceof Error?e.message:JSON.stringify(e)})}))}},children:"Request Withdrawal"})})]})]})}var Ht,Jt;const Qt=ze.a.div(Ht||(Ht=Object(me.a)(["\n  width: 436px;\n  background: rgb(39, 37, 52);\n  border-radius: 24px;\n  color: white;\n  .request-withdrawal {\n    padding: 24px;\n  }\n  .title {\n    font-size: 20px;\n    font-weight: 600;\n    line-height: 1.1;\n    margin-bottom: 8px;\n  }\n  .description {\n    font-weight: 400;\n    line-height: 1.5;\n    font-size: 14px;\n  }\n  .button-container {\n    margin-top: 16px;\n  }\n  .request-button {\n    -webkit-box-align: center;\n    align-items: center;\n    border: 0px;\n    border-radius: 16px;\n    box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;\n    cursor: pointer;\n    display: inline-flex;\n    font-family: inherit;\n    font-size: 16px;\n    font-weight: 600;\n    -webkit-box-pack: center;\n    justify-content: center;\n    letter-spacing: 0.03em;\n    line-height: 1;\n    opacity: 1;\n    outline: 0px;\n    transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;\n    height: 48px;\n    padding: 0px 24px;\n    background-color: rgb(255, 67, 66);\n    color: white;\n  }\n"]))),Kt=ze.a.div(Jt||(Jt=Object(me.a)(["\n  > .header {\n    -webkit-box-align: center;\n    align-items: center;\n    -webkit-box-pack: justify;\n    justify-content: space-between;\n    padding: 24px;\n    width: 100%;\n    border-bottom: 1px solid rgb(60, 58, 75);\n    border-top: 1px solid rgb(60, 58, 75);\n    font-size: 16px;\n    font-weight: 600;\n    line-height: 1.5;\n  }\n  .list {\n    max-height: calc(100vh - 400px);\n    overflow-y: auto;\n    background-color: rgb(16, 12, 24);\n    padding: 24px;\n    border-bottom-left-radius: 24px;\n    border-bottom-right-radius: 24px;\n    & > div {\n      margin-bottom: 16px;\n    }\n  }\n"])));var Vt,Yt,Xt,Zt,$t,en,tn=()=>{const[e,t]=Object(a.useState)([]),n=Ie(),s=function(){const[e,t]=Object(a.useState)((()=>Date.now()));return Object(a.useEffect)((()=>{const e=()=>{t(Date.now()),setTimeout(e,1e3)};setTimeout(e,1e3)}),[]),e}();return Object(a.useEffect)((()=>{(async()=>{if(n){const e=await(null===n||void 0===n?void 0:n.listWithdraw());t(e)}})()}),[n]),Object(fe.jsx)(Rt,{children:Object(fe.jsxs)(Qt,{className:"content",children:[Object(fe.jsxs)("div",{className:"request-withdrawal",children:[Object(fe.jsx)("div",{className:"title",children:"Withdrawal"}),Object(fe.jsx)("div",{className:"description",children:"To withdraw assets back to Layer 1, you need to have CKB balance in your L1 Wallet Address"}),Object(fe.jsx)("div",{className:"button-container",children:Object(fe.jsx)(o.b,{to:"/request-withdrawal",className:"request-button",children:"Request Withdrawal"})})]}),Object(fe.jsxs)(Kt,{className:"withdrawal-request",children:[Object(fe.jsx)("div",{className:"header",children:"Your Withdrawal Requests"}),Object(fe.jsx)("div",{className:"list",children:e.map(((e,t)=>Object(a.createElement)(dt,{now:s,...e,key:t})))})]})]})})};const{Text:nn}=ke.a,an=ze.a.div(Vt||(Vt=Object(me.a)(["\n  width: 436px;\n  background: rgb(39, 37, 52);\n  border-radius: 24px;\n  color: white;\n"]))),sn=ze.a.div(Yt||(Yt=Object(me.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  padding: 24px;\n  a,\n  .ant-typography {\n    color: white;\n  }\n  .title {\n    font-weight: bold;\n    font-size: 20px;\n    padding-bottom: 5px;\n  }\n  .description {\n    font-size: 14px;\n  }\n"]))),rn=ze.a.div(Xt||(Xt=Object(me.a)(["\n  padding: 24px;\n  grid-auto-rows: auto;\n  row-gap: 8px;\n  .icon {\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    padding-top: 8px;\n    padding-bottom: 8px;\n  }\n"]))),on=ze.a.div(Zt||(Zt=Object(me.a)(["\n  display: flex;\n  flex-direction: column;\n  margin: 24px;\n  padding: 16px;\n  border: 1px solid rgb(60, 58, 75);\n  border-radius: 16px;\n  .ant-typography {\n    color: white;\n  }\n  .title {\n    font-size: 16px;\n    padding-bottom: 10px;\n  }\n  .address {\n    font-size: 16px;\n    padding-bottom: 10px;\n  }\n  .copy {\n    color: rgb(255, 67, 66);\n    .ant-typography {\n      font-size: 14px;\n      color: rgb(255, 67, 66);\n      padding-right: 5px;\n    }\n  }\n"]))),cn=ze.a.div($t||($t=Object(me.a)(["\n  margin-top: 20px;\n  display: flex;\n  justify-content: center;\n  .submit-button {\n    align-items: center;\n    border: 0px;\n    border-radius: 16px;\n    box-shadow: rgb(14 14 44 / 40%) 0px -1px 0px 0px inset;\n    cursor: pointer;\n    display: inline-flex;\n    font-family: inherit;\n    font-size: 16px;\n    font-weight: 600;\n    -webkit-box-pack: center;\n    justify-content: center;\n    letter-spacing: 0.03em;\n    line-height: 1;\n    opacity: 1;\n    outline: 0px;\n    transition: background-color 0.2s ease 0s, opacity 0.2s ease 0s;\n    height: 48px;\n    padding: 0px 24px;\n    background-color: rgb(255, 67, 66);\n    color: white;\n    width: 100%;\n    &:disabled {\n      background-color: rgb(60, 55, 66);\n      border-color: rgb(60, 55, 66);\n      box-shadow: none;\n      color: rgb(104, 102, 123);\n      cursor: not-allowed;\n    }\n  }\n  button:hover {\n    cursor: pointer;\n  }\n"]))),ln=Object(ze.a)(Ae.a)(en||(en=Object(me.a)(["\n  color: white;\n  .ant-modal-content {\n    border-radius: 32px;\n    background: rgb(39, 37, 52);\n    box-shadow: rgb(14 14 44 / 10%) 0px 20px 36px -8px, rgb(0 0 0 / 5%) 0px 1px 1px;\n    border: 1px solid rgb(60, 58, 75);\n    color: white;\n  }\n  .ant-modal-header {\n    background: rgb(39, 37, 52);\n    border: 1px solid rgb(60, 58, 75);\n    border-top-left-radius: 32px;\n    border-top-right-radius: 32px;\n    padding: 12px 24px;\n    height: 73px;\n    display: flex;\n    align-items: center;\n  }\n  .ant-modal-title,\n  .ant-list-item {\n    color: white;\n  }\n  .ant-modal-body {\n    padding: 24px;\n  }\n  .ant-modal-close-x {\n    color: white;\n  }\n  .ant-typography {\n    color: white;\n    justify-content: space-between;\n  }\n  .tips {\n    margin: 24px 0;\n  }\n"])));function dn(){const[e,t]=Object(a.useState)(""),[n,s]=Object(a.useState)(""),[i,r]=Object(a.useState)(!1),[o,c]=Object(a.useState)(!0),[l,d]=Object(a.useState)(),p=Ie();Object(a.useEffect)((()=>{Number(e)>=400?c(!1):c(!0)}),[e]);return Object(fe.jsxs)(Rt,{children:[Object(fe.jsxs)(an,{children:[Object(fe.jsxs)(sn,{className:"header",children:[Object(fe.jsx)(nn,{className:"title",children:"Deposit To Layer2"}),Object(fe.jsx)(nn,{className:"description",children:"To deposit, transfer CKB or supported sUDT tokens to your L1 Wallet Address first"})]}),Object(fe.jsxs)(on,{children:[Object(fe.jsx)(nn,{className:"title",children:"L1 Wallet Address"}),Object(fe.jsx)(nn,{className:"address",children:null===p||void 0===p?void 0:p.provider.getL1Address()}),Object(fe.jsxs)("div",{className:"copy",children:[Object(fe.jsx)(nn,{children:"Copy Address"}),Object(fe.jsx)(yt.a,{})]})]}),Object(fe.jsxs)(rn,{className:"main",children:[Object(fe.jsx)(We,{value:e,onUserInput:t,label:"Deposit",isL1:!0}),Object(fe.jsx)("div",{className:"icon",children:Object(fe.jsx)(ve.a,{})}),Object(fe.jsx)(xt,{value:n,onUserInput:s,label:"sUDT(optional)",onSelectedChange:e=>{d(e)},isL1:!0}),Object(fe.jsx)(cn,{children:Object(fe.jsx)(Be.a,{className:"submit-button",disabled:o,onClick:async()=>{if(r(!0),p){const t=BigInt(e)*BigInt(Math.pow(10,8));let a="0x0";l&&(a="0x"+BigInt(Number(n)*Math.pow(10,l.decimals)).toString(16));const s=await p.deposit({capacity:"0x"+t.toString(16),amount:a,sudtType:null===l||void 0===l?void 0:l.type});console.log(s),r(!1)}},children:"Deposit"})})]}),Object(fe.jsx)("div",{className:"footer"})]}),Object(fe.jsxs)(ln,{title:"Confirm Transaction",visible:i,onCancel:()=>{r(!1)},footer:null,children:[Object(fe.jsx)(nn,{children:"Waiting For Confirmation"}),Object(fe.jsxs)(nn,{children:["Depositing ",n," ",null===l||void 0===l?void 0:l.symbol," and ",e," CKB"]}),Object(fe.jsx)("div",{className:"tips",children:"Confirm this transaction in your wallet"})]})]})}var pn=function(){return Object(fe.jsx)(we,{children:Object(fe.jsx)(o.a,{children:Object(fe.jsxs)(c.c,{children:[Object(fe.jsx)(c.a,{path:"/",element:Object(fe.jsx)(tn,{})}),Object(fe.jsx)(c.a,{path:"/request-withdrawal",element:Object(fe.jsx)(Ft,{})}),Object(fe.jsx)(c.a,{path:"/deposit",element:Object(fe.jsx)(dn,{})})]})})})};var hn=e=>{e&&e instanceof Function&&import("web-vitals").then((t=>{let{getCLS:n,getFID:a,getFCP:s,getLCP:i,getTTFB:r}=t;n(e),a(e),s(e),i(e),r(e)}))};n(819);p.config.initializeConfig(p.config.predefined.AGGRON4),r.a.render(Object(fe.jsx)(s.a.StrictMode,{children:Object(fe.jsx)(pn,{})}),document.getElementById("root")),hn()}},[[820,1,2]]]);
//# sourceMappingURL=main.81e77cf7.chunk.js.map